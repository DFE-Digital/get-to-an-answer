@model Admin.Models.QuestionnaireViewModel

@{
    ViewData["Title"] = "Compare questionnaires";
}

<style>
/* Keep JSON formatting */
.json-view { white-space: pre; line-height: 1.4; tab-size: 2; font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, "Liberation Mono", monospace; }
/* Accessible highlights: color + border/text decoration */
.diff-added   { background-color: #e6f4ea; border-left: 3px solid #00703c; }
.diff-removed { background-color: #fbe9e7; border-left: 3px solid #d4351c; text-decoration: line-through; }
.diff-modified{ background-color: #fff7e6; border-left: 3px solid #ffbf47; }
</style>

@section BeforeContent
{
  <a class="govuk-back-link govuk-!-display-none-print" href="/admin/questionnaires/@Model.QuestionnaireId/track">Back to questionnaire</a>
}

<div class="app-split-pane app-width-container app-main-wrapper">
  <div class="app-split-pane__nav">
<!-- [html-validate-disable-next no-unused-disable, unique-landmark -- allow 2 navs with the same aria-labelledby because they contain the same information] -->
<nav class="app-subnav" aria-labelledby="app-subnav-heading">
  <h3 id="app-subnav-heading">Previous Versions</h3>
    <ul class="app-subnav__section">
      @foreach (var version in Model.QuestionnaireVersions)
      {
        <li class="app-subnav__section-item @(version.Version == Model.CurrentVersion ? "app-subnav__section-item--current" : "")">
          <a class="app-subnav__link govuk-link govuk-link--no-visited-state govuk-link--no-underline" href="/admin/questionnaires/@version.QuestionnaireId/versions/@version.Version/compare">
            @($"{version.CreatedAt:yyyy-MM-dd HH:mm:ss}")
          </a>
        </li>
      }
    </ul>
    </nav>
      </div>
      <div class="app-split-pane__content">
        <nav class="govuk-breadcrumbs app-breadcrumbs" aria-label="Breadcrumb">
      <ol class="govuk-breadcrumbs__list">
        <li class="govuk-breadcrumbs__list-item">
          <a class="govuk-breadcrumbs__link" href="/">Home</a>
        </li>
        <li class="govuk-breadcrumbs__list-item">
          <a class="govuk-breadcrumbs__link" href="/components">Components</a>
        </li>
      </ol>
    </nav>

    <main id="main-content" class="app-content" role="main">
      <h1 class="govuk-heading-l">Compare questionnaires</h1>

      <div class="govuk-grid-row">
        <div class="govuk-summary-card">
          <div class="govuk-summary-card__title-wrapper">
            <h2 class="govuk-summary-card__title">
              Version @Model.OtherVersion
            </h2>
          </div>
          <div class="govuk-summary-card__content">
            <div>
              <pre class="json-view"><code>@Html.Raw(Model.OtherVersionHtml)</code></pre>
            </div>
          </div>
        </div>
      </div>
      <div class="govuk-grid-row">
        <div class="govuk-summary-card">
          <div class="govuk-summary-card__title-wrapper">
            <h2 class="govuk-summary-card__title">
              Current Version (@Model.CurrentVersion)
            </h2>
          </div>
          <div class="govuk-summary-card__content">
            <div>
              <pre class="json-view"><code>@Html.Raw(Model.CurrentVersionHtml)</code></pre>
            </div>
          </div>
        </div>
      </div>
    </main>
  </div>
<div class="app-back-to-top" data-module="app-back-to-top" data-app-back-to-top-init="">
  <a class="govuk-link govuk-link--no-visited-state app-back-to-top__link" href="#top">
    <svg role="presentation" focusable="false" class="app-back-to-top__icon" xmlns="http://www.w3.org/2000/svg" width="13" height="17" viewBox="0 0 13 17">
      <path fill="currentColor" d="M6.5 0L0 6.5 1.4 8l4-4v12.7h2V4l4.3 4L13 6.4z"></path>
    </svg>Back to top
  </a>
</div>
</div>