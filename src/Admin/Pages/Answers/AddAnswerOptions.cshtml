@page "/admin/questionnaires/{questionnaireId:guid}/questions/{questionId:guid}/answers/add"
@addTagHelper *, Common
@using Admin.Models
@using Common.Enum
@model Admin.Pages.Answers.AddAnswerOptionOptions

@{
  Layout = "_Layout";
  ViewData["Title"] = "Create a list of answer options";
}

@section BeforeContent
{
  <a class="govuk-back-link govuk-!-display-none-print" href="@Model?.BackLinkSlug">Back</a>
}

@if (Model!.HasErrors())
{
  @await Html.PartialAsync("_ErrorSummary")
}

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">

    <h1 class="govuk-heading-l">
      <p class="govuk-caption-l">Question @Model.QuestionNumber</p>
      Create a list of answer options
    </h1>
    <dl class="govuk-!-margin-bottom-7">
      <dt class="govuk-visually-hidden">Status</dt>
      <dd class="govuk-!-margin-0"><strong class="govuk-tag" data-status="@Model?.QuestionnaireStatus">@Model?.QuestionnaireStatus</strong>
      </dd>
    </dl>

    <p class="govuk-body">
      People will be able to select one option from your list.
    </p>
    <div class="govuk-body gtaa-add-edit-questions-page">
      You can add your options individually below, or you can
    
      <form method="post" accept-charset="UTF-8">
        <input name="returnUrl" type="hidden" value="@($"{Request.Path}{Request.QueryString}")"/>
        <button type="submit" asp-page-handler="RedirectToBulkEntry"
                class="govuk-button govuk-button--link govuk-!-margin-left-4">
          enter all the options into one text box
        </button>
      </form>
    </div>

    <h2 class="govuk-heading-m govuk-!-margin-top-6">Add answer options to your list</h2>

    <form method="post" accept-charset="UTF-8">
      <input type="hidden" asp-for="RetrievedQuestionType"/>

      @for (var i = 0; i < Model.Options.Count; i++)
      {
        var viewData = new ViewDataDictionary(ViewData)
        {
          TemplateInfo =
          {
            HtmlFieldPrefix = $"Options[{i}]"
          }
        };

        @await Html.PartialAsync("AnswerOptionsPartial", Model.Options[i], viewData)
        
        <button class="govuk-button govuk-button--secondary govuk-!-margin-top-3"
                type="submit"
                asp-page-handler="RemoveOption">
          Remove
        </button>
      }

      <div class="govuk-!-margin-top-3 govuk-!-display-flex govuk-!-gap-3 govuk-!-flex-wrap  gtaa-add-edit-questions-page">
        <button class="govuk-button govuk-button--secondary"
                type="submit"
                asp-page-handler="AddOption">
          Add another option
        </button>
        
          <input name="returnUrl" type="hidden" value="@($"{Request.Path}{Request.QueryString}")"/>
          <button type="submit" asp-page-handler="RedirectToBulkEntry"
                  class="govuk-button govuk-button--link govuk-!-margin-left-4">
            Enter all the options into one text box
        </button>
        
      </div>

      <button class="govuk-button govuk-!-margin-top-6"
              asp-page-handler="Continue"
              type="submit"
              formnovalidate="formnovalidate"
              data-module="govuk-button"
              data-prevent-double-click="true"
              data-govuk-button-init="">
        Continue
      </button>
    </form>
  </div>
</div>